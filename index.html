<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Head Tracker + Notion Tasks</title>
  <style>
    body { margin: 0; overflow: hidden; }
    #container { position: relative; }
    #video { width: 100vw; height: 100vh; object-fit: cover; }
    .balloon {
      position: absolute;
      background: rgba(255,255,255,0.9);
      border-radius: 12px;
      padding: 8px 12px;
      font-family: sans-serif;
      font-size: 14px;
      transform: translate(-50%, -100%);
    }
  </style>
</head>
<body>
  <div id="container">
    <video id="video" autoplay playsinline></video>
  </div>

  <script type="module">
    import { FaceMesh } from "https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh";
    import { Camera } from "https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils";

    const video = document.getElementById("video");
    const container = document.getElementById("container");
    const balloons = [];

    async function getTasks() {
      const res = await fetch("https://your-backend-url/tasks");
      return await res.json();
    }

    const tasks = await getTasks();

    const faceMesh = new FaceMesh({
      locateFile: file => `https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${file}`
    });
    faceMesh.setOptions({ maxNumFaces: 5, minDetectionConfidence: 0.6 });
    faceMesh.onResults(results => {
      container.querySelectorAll('.balloon').forEach(b => b.remove());

      results.multiFaceLandmarks.forEach((lm, i) => {
        const nose = lm[1]; // near head center
        const x = nose.x * window.innerWidth;
        const y = nose.y * window.innerHeight - 80; // offset above head
        const div = document.createElement('div');
        div.className = 'balloon';
        const person = tasks[i % tasks.length]; // temporary mapping
        div.textContent = `${person.name}: ${person.task} (${person.status})`;
        div.style.left = `${x}px`;
        div.style.top = `${y}px`;
        container.appendChild(div);
      });
    });

    const camera = new Camera(video, {
      onFrame: async () => { await faceMesh.send({ image: video }); },
      width: 1280, height: 720
    });
    camera.start();
  </script>
</body>
</html>
